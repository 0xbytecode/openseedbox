#{extends "admin/index.html" /}
<style type="text/css">
	#nodes td {
		vertical-align: middle;
	}
</style>
<h2>Nodes</h2>
<table id="nodes" class="table table-bordered table-condensed">
	<tr>
		<th>Name</th>
		<th>IP Address</th>
		<th style="width:20%;">Uptime</th>
		<th>Free Space</th>
		<th>Used Space</th>
		<th>Users</th>
		<th>Active</th>
		<th>Action</th>
	</tr>
#{list items:nodes, as:"node"}
	<tr class="node-${node.id}">
		#{if (node.isReachable())}
			<td><a href="https://${node.ipAddress}/openseedbox-server/status.php" target="_blank">${node.name}</a></td>
			<td>${node.ipAddress}</td>
			<td>${node.getUptime().raw()}</td>
			<td>${node.getFreeSpace()}</td>
			<td>${node.getUsedSpace()}</td>
			<td>${node.getUserCount()}</td>
		#{/if}
		#{else}
			<td><a href="https://${node.ipAddress}/openseedbox-server/status.php" target="_blank">${node.name}</a></td>
			<td>${node.ipAddress}</td>
			<td><span class="error">Node is not reachable!</span></td>
			<td></td>
			<td></td>
			<td></td>
		#{/else}
		<td>
			#{if (node.active)}
				<span style="color:green;">Yes</span>
			#{/if}
			#{else}
				<span style="color:red;">No</span>
			#{/else}
		</td>
		<td>			
			<a class="btn btn-primary btn-small" href="@{AdminController.editNode(node)}">Edit</a>
			<a class="btn btn-danger btn-small pull-right" href="@{AdminController.deleteNode(node.id)}">Delete</a>
		</td>
	</tr>
#{/list}
</table>
<div class="form-actions">
	<a href="@{AdminController.editNode}" class="btn btn-primary">Create new Node</a>
</div>
<h2>Actions for All Nodes</h2>
<a class="btn btn-primary" href="@{AdminController.updateTransmissionConfig}">Update Transmission Config</a>
<a class="btn btn-primary" href="@{AdminController.runPrepareScript}">Run prepare script on all nodes</a>